<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Device Control</title>
    <link rel="stylesheet" href="./assets/css/smartdim.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="group-name">üí°–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ–º</div>
            <input type="text" id="deviceNameInput" class="device-name-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"
                value="Smart Dimmer #1">
            <div class="status">
                <div class="status-dot"></div>
                –û–Ω–ª–∞–π–Ω
            </div>
        </div>

        <div class="content">
            <div class="section">
                <div class="section-title">–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ</div>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">24.5¬∞C</div>
                        <div class="data-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">65%</div>
                        <div class="data-label">–í–ª–∞–∂–Ω–æ—Å—Ç—å</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">1.2 kPa</div>
                        <div class="data-label">VPD</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">45%</div>
                        <div class="data-label">LED —è—Ä–∫–æ—Å—Ç—å</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Å–≤–µ—â–µ–Ω–∏—è</div>
                <div class="lighting-control-container">
                    <div class="form-group">
                        <div class="range-group">
                            <div class="range-header">
                                <label class="form-label" style="margin-bottom: 0;">–ù–∞—á–∞–ª—å–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å</label>
                                <span class="range-value" id="minBrightnessValue">10%</span>
                            </div>
                            <input type="range" class="range-input" min="0" max="100" value="10" id="minBrightness">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="range-group">
                            <div class="range-header">
                                <label class="form-label" style="margin-bottom: 0;">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å</label>
                                <span class="range-value" id="maxBrightnessValue">80%</span>
                            </div>
                            <input type="range" class="range-input" min="0" max="100" value="80" id="maxBrightness">
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
                <div class="schedule-container">
                    <div class="time-row">
                        <div class="time-input-group">
                            <div class="time-label">–í–∫–ª—é—á–µ–Ω–∏–µ</div>
                            <input type="time" class="time-input" value="08:00">
                        </div>
                        <div class="time-separator">‚Üí</div>
                        <div class="time-input-group">
                            <div class="time-label">–í—ã–∫–ª—é—á–µ–Ω–∏–µ</div>
                            <input type="time" class="time-input" value="20:00">
                        </div>
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">–†–∞—Å—Å–≤–µ—Ç/–∑–∞–∫–∞—Ç:</div>
                        <div class="setting-control">
                            <select class="modern-select">
                                <option value="30">30 –º–∏–Ω</option>
                                <option value="45">45 –º–∏–Ω</option>
                                <option value="60" selected>60 –º–∏–Ω</option>
                                <option value="90">90 –º–∏–Ω</option>
                                <option value="120">120 –º–∏–Ω</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</div>
                        <div class="setting-control">
                            <select class="modern-select">
                                <option value="-12">UTC-12</option>
                                <option value="-11">UTC-11</option>
                                <option value="-10">UTC-10</option>
                                <option value="-9">UTC-9</option>
                                <option value="-8">UTC-8</option>
                                <option value="-7">UTC-7</option>
                                <option value="-6">UTC-6</option>
                                <option value="-5">UTC-5</option>
                                <option value="-4">UTC-4</option>
                                <option value="-3">UTC-3</option>
                                <option value="-2">UTC-2</option>
                                <option value="-1">UTC-1</option>
                                <option value="0">UTC+0</option>
                                <option value="1">UTC+1</option>
                                <option value="2">UTC+2</option>
                                <option value="3" selected>UTC+3</option>
                                <option value="4">UTC+4</option>
                                <option value="5">UTC+5</option>
                                <option value="6">UTC+6</option>
                                <option value="7">UTC+7</option>
                                <option value="8">UTC+8</option>
                                <option value="9">UTC+9</option>
                                <option value="10">UTC+10</option>
                                <option value="11">UTC+11</option>
                                <option value="12">UTC+12</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è:</div>
                        <div class="current-time-display">12:35</div>
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:</div>
                        <button class="sync-button" onclick="syncTime()">Sync</button>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">–ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</div>
                <div class="temp-control-container">
                    <div class="toggle-row">
                        <div class="setting-label">–†–µ–∂–∏–º –∫–æ–Ω—Ç—Ä–æ–ª—è:</div>
                        <label class="modern-toggle">
                            <input type="checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <div class="range-group">
                            <div class="range-header">
                                <label class="form-label" style="margin-bottom: 0;">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</label>
                                <span class="range-value" id="minTempValue">27¬∞C</span>
                            </div>
                            <input type="range" class="range-input" min="15" max="40" value="27" id="minTemp">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="range-group">
                            <div class="range-header">
                                <label class="form-label" style="margin-bottom: 0;">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</label>
                                <span class="range-value" id="maxTempValue">28¬∞C</span>
                            </div>
                            <input type="range" class="range-input" min="15" max="40" value="28" id="maxTemp">
                        </div>
                    </div>
                </div>
            </div>

            <button class="save-btn" onclick="saveSettings()">
                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            </button>

            <div class="buttons-row">
                <button class="btn-secondary" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                </button>
                <button class="btn-danger" onclick="unbindDevice()">
                    <i class="fas fa-unlink"></i> –û—Ç–≤—è–∑–∞—Ç—å
                </button>
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã Telegram
        document.documentElement.style.setProperty('--tg-theme-bg-color', tg.backgroundColor);
        document.documentElement.style.setProperty('--tg-theme-text-color', tg.textColor);
        document.documentElement.style.setProperty('--tg-theme-hint-color', tg.hintColor);
        document.documentElement.style.setProperty('--tg-theme-button-color', tg.buttonColor);
        document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.buttonTextColor);
        document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', tg.secondaryBgColor);

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–º–Ω—É—é —Ç–µ–º—É –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
        const isDarkTheme = tg.colorScheme === 'dark';
        if (isDarkTheme) {
            const darkContainerStyle = document.createElement('style');
            darkContainerStyle.textContent = `
                .data-card,
                .lighting-control-container,
                .schedule-container,
                .temp-control-container,
                .time-input,
                .modern-select {
                    background: #28283c !important;
                }
                .setting-row {
                    border-bottom: 1px solid #404050 !important;
                }
                .setting-row:last-child {
                    border-bottom: none !important;
                    padding-bottom: 0 !important;
                }
                .toggle-row {
                    border-bottom: 1px solid #404050 !important;
                }
            `;
            document.head.appendChild(darkContainerStyle);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–ª–∑—É–Ω–∫–∞
        function updateRangeProgress(input) {
            const value = ((input.value - input.min) / (input.max - input.min)) * 100;
            input.style.setProperty('--range-progress', value + '%');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Å–ª–∞–π–¥–µ—Ä–æ–≤ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        document.getElementById('minBrightness').addEventListener('input', function () {
            const maxBrightness = document.getElementById('maxBrightness');
            const minValue = parseInt(this.value);
            const maxValue = parseInt(maxBrightness.value);

            // –ï—Å–ª–∏ –Ω–∞—á–∞–ª—å–Ω–∞—è –±–æ–ª—å—à–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –Ω–∞ 1% –≤—ã—à–µ
            if (minValue >= maxValue) {
                maxBrightness.value = minValue + 1;
                document.getElementById('maxBrightnessValue').textContent = maxBrightness.value + '%';
                updateRangeProgress(maxBrightness);
            }

            document.getElementById('minBrightnessValue').textContent = this.value + '%';
            updateRangeProgress(this);
        });

        document.getElementById('maxBrightness').addEventListener('input', function () {
            const minBrightness = document.getElementById('minBrightness');
            const minValue = parseInt(minBrightness.value);
            const maxValue = parseInt(this.value);

            // –ï—Å–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–µ–Ω—å—à–µ –Ω–∞—á–∞–ª—å–Ω–æ–π, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –Ω–∞ 1% –Ω–∏–∂–µ
            if (maxValue <= minValue) {
                minBrightness.value = maxValue - 1;
                document.getElementById('minBrightnessValue').textContent = minBrightness.value + '%';
                updateRangeProgress(minBrightness);
            }

            document.getElementById('maxBrightnessValue').textContent = this.value + '%';
            updateRangeProgress(this);
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö —Å–ª–∞–π–¥–µ—Ä–æ–≤ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        document.getElementById('minTemp').addEventListener('input', function () {
            const maxTemp = document.getElementById('maxTemp');
            const minValue = parseInt(this.value);
            const maxValue = parseInt(maxTemp.value);

            // –ï—Å–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±–æ–ª—å—à–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –Ω–∞ 1 –≥—Ä–∞–¥—É—Å –≤—ã—à–µ
            if (minValue >= maxValue) {
                maxTemp.value = minValue + 1;
                document.getElementById('maxTempValue').textContent = maxTemp.value + '¬∞C';
                updateRangeProgress(maxTemp);
            }

            document.getElementById('minTempValue').textContent = this.value + '¬∞C';
            updateRangeProgress(this);
        });

        document.getElementById('maxTemp').addEventListener('input', function () {
            const minTemp = document.getElementById('minTemp');
            const minValue = parseInt(minTemp.value);
            const maxValue = parseInt(this.value);

            // –ï—Å–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –Ω–∞ 1 –≥—Ä–∞–¥—É—Å –Ω–∏–∂–µ
            if (maxValue <= minValue) {
                minTemp.value = maxValue - 1;
                document.getElementById('minTempValue').textContent = minTemp.value + '¬∞C';
                updateRangeProgress(minTemp);
            }

            document.getElementById('maxTempValue').textContent = this.value + '¬∞C';
            updateRangeProgress(this);
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–ª–∑—É–Ω–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function () {
            updateRangeProgress(document.getElementById('minBrightness'));
            updateRangeProgress(document.getElementById('maxBrightness'));
            updateRangeProgress(document.getElementById('minTemp'));
            updateRangeProgress(document.getElementById('maxTemp'));
        });

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        function saveSettings() {
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            const btn = document.querySelector('.save-btn');
            const originalText = btn.textContent;
            btn.textContent = '–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ‚úì';
            btn.style.background = 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)';

            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)';
            }, 2000);
        }

        function syncTime() {
            const btn = document.querySelector('.sync-btn');
            const originalText = btn.textContent;
            btn.textContent = '‚ü≥';
            btn.style.animation = 'spin 1s linear infinite';

            setTimeout(() => {
                btn.textContent = '‚úì';
                btn.style.animation = 'none';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 1000);
            }, 1500);
        }

        function goBack() {
            window.location.href = '../index.html';
        }

        function unbindDevice() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ?')) {
                const btn = document.querySelector('.unbind-btn');
                btn.textContent = '–û—Ç–≤—è–∑–∞–Ω–æ';
                btn.style.background = '#fed7d7';
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ru-RU', {
                hour: '2-digit',
                minute: '2-digit'
            });
            document.querySelector('.current-time-display').textContent = timeString;
        }

        setInterval(updateTime, 1000);
        updateTime();

        // CSS –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'96aec80a71762406',t:'MTc1NDQ4NTkwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>